"use strict";angular.module("appliMobileBatiChiffrageApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.bootstrap","angular.filter"]).run(["$rootScope",function(a){a.filter={},a.config={authentificated:!1,msgError:!1,UrlBC:"chiffrage.batiactu.com"}}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/main",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/myroute",{templateUrl:"views/myroute.html",controller:"MyrouteCtrl"}).when("/projet/:PrId",{templateUrl:"views/projet.html",controller:"ProjetCtrl"}).when("/projets",{templateUrl:"views/projets.html",controller:"ProjetsCtrl"}).when("/fournitures/:PrId",{templateUrl:"views/fournitures.html",controller:"FournituresCtrl"}).when("/clients",{templateUrl:"views/clients.html",controller:"ClientsCtrl"}).when("/client/:GCId",{templateUrl:"views/client.html",controller:"ClientCtrl"}).when("/chiffrage",{templateUrl:"views/chiffrage.html",controller:"ChiffrageCtrl"}).when("/contact",{templateUrl:"views/contact.html",controller:"ContactCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("appliMobileBatiChiffrageApp").controller("MainCtrl",["$scope","$rootScope","$http","$location",function(a,b,c,d){if(0==a.config.authentificated)a.config.msgError=!1,d.path("login");else{a.config.authentificated=!0;var e="http://"+a.config.UrlBC+"/scripts/interfaceEL.php?mode=GET_PROJETS_FAVORIS_CLIENT&UId="+a.config.UId+"&order=ORDER+BY+p.dt_maj+DESC%2Cp.dt_cre+DESC%2Cp.id+DESC&filtre_mask_etat=",f="http://"+a.config.UrlBC+"/scripts/interfaceEL.php?mode=GET_LISTE_GCLIENTS&UId="+a.config.UId+"&type=CLIENT&order=ORDER+BY+nom+ASC%2C+dt_cre+DESC%2C+id+DESC&IDX";c.post(e).success(function(b,c){a.projets=b;var d=b.length-1;d>5?a.countProj=5:a.countProj=d}),c.post(f).success(function(b,c){a.clients=b.liste;var d=b.liste.length;d>5?a.countClient=5:a.countClient=d}),a.arrondiPrix=function(a){return Math.round(100*a)/100};var g=window.location.hash.split("/")[1],h=g.substring(g.length-1,g.length);"s"!=h&&(g+="s"),$("#navbar ul li").removeClass("active"),$("#navbar ul li#"+g).addClass("active")}}]),angular.module("appliMobileBatiChiffrageApp").controller("AboutCtrl",["$scope",function(a){var b=window.location.hash.split("/")[1],c=b.substring(b.length-1,b.length);"s"!=c&&(b+="s"),$("#navbar ul li").removeClass("active"),$("#navbar ul li#"+b).addClass("active")}]),angular.module("appliMobileBatiChiffrageApp").controller("ContactCtrl",["$scope",function(a){var b=window.location.hash.split("/")[1],c=b.substring(b.length-1,b.length);"s"!=c&&(b+="s"),$("#navbar ul li").removeClass("active"),$("#navbar ul li#"+b).addClass("active")}]),angular.module("appliMobileBatiChiffrageApp").controller("ProjetCtrl",["$scope","$rootScope","$http","$location","$routeParams",function(a,b,c,d,e){if(0==a.config.authentificated)a.config.msgError=!1,d.path("login");else{a.oneAtATime=!0,a.status={isFirstOpen:!1,isFirstDisabled:!1};var f="http://"+a.config.UrlBC+"/scripts/interfaceEL.php?mode=GET_PROJET&fonction=loadProjet&async=false&PrId="+e.PrId;c.post(f).success(function(b,c){a.projet=b,a.lignes=b.TLigne}),a.arrondiPrix=function(a){return Math.round(100*a)/100},a.formatDate=function(a){var b=a.split("-"),c=b[2].split(" ");return c[0]+"-"+b[1]+"-"+b[0]},a.testLibelle=function(a){return"<NULL>"==a?!1:!0},a.calcultva=function(a){var b=100*(a-1);return Math.round(100*b)/100};var g=window.location.hash.split("/")[1],h=g.substring(g.length-1,g.length);"s"!=h&&(g+="s"),$("#navbar ul li").removeClass("active"),$("#navbar ul li#"+g).addClass("active")}}]),angular.module("appliMobileBatiChiffrageApp").controller("ProjetsCtrl",["$scope","$rootScope","$http","$location",function(a,b,c,d){if(0==a.config.authentificated)a.config.msgError=!1,d.path("login");else{var e="http://"+a.config.UrlBC+"/scripts/interfaceEL.php?mode=GET_PROJETS_FAVORIS_CLIENT&UId="+a.config.UId+"&order=ORDER+BY+p.dt_maj+DESC%2Cp.dt_cre+DESC%2Cp.id+DESC&filtre_mask_etat=";c.post(e).success(function(b,c){a.projets=b;var d=b.length-1;d>5?a.countProj=5:a.countProj=d}),a.arrondiPrix=function(a){return Math.round(100*a)/100};var f=window.location.hash.split("/")[1],g=f.substring(f.length-1,f.length);"s"!=g&&(f+="s"),$("#navbar ul li").removeClass("active"),$("#navbar ul li#"+f).addClass("active")}}]),angular.module("appliMobileBatiChiffrageApp").controller("FournituresCtrl",["$scope","$rootScope","$http","$location","$routeParams",function(a,b,c,d,e){if(0==a.config.authentificated)a.config.msgError=!1,d.path("login");else{var f="http://"+a.config.UrlBC+"/scripts/interfaceEL.php?mode=GET_PROJET&fonction=loadProjet&async=false&PrId="+e.PrId;c.post(f).success(function(b,c){a.projet=b,a.lignes=b.TLigne;var d=new Array;angular.forEach(b.TLigne,function(a,b){angular.forEach(a.TCompo,function(a,b){this.push(a)},d)}),a.listeCompos=d}),a.arrondiPrix=function(a){return Math.round(100*a)/100}}}]),angular.module("appliMobileBatiChiffrageApp").controller("ClientCtrl",["$scope","$http","$location","$routeParams",function(a,b,c,d){if(0==a.config.authentificated)a.config.msgError=!1,c.path("login");else{var e="http://"+a.config.UrlBC+"/scripts/interfaceEL.php?mode=GET_GCLIENT&fonction=loadGClient&async=false&GCId="+d.GCId;b.post(e).success(function(b,c){a.client=b,a.projetsLies=b.TListe_projets_lies,a.countProjetLie=b.TListe_projets_lies.length});var f=window.location.hash.split("/")[1],g=f.substring(f.length-1,f.length);"s"!=g&&(f+="s"),$("#navbar ul li").removeClass("active"),$("#navbar ul li#"+f).addClass("active")}}]),angular.module("appliMobileBatiChiffrageApp").controller("ClientsCtrl",["$scope","$rootScope","$http","$location",function(a,b,c,d){if(0==a.config.authentificated)a.config.msgError=!1,d.path("login");else{var e="http://"+a.config.UrlBC+"/scripts/interfaceEL.php?mode=GET_LISTE_GCLIENTS&UId="+a.config.UId+"&type=CLIENT&order=ORDER+BY+nom+ASC%2C+dt_cre+DESC%2C+id+DESC&IDX";c.post(e).success(function(b,c){a.clients=b.liste;b.liste.length});var f=window.location.hash.split("/")[1],g=f.substring(f.length-1,f.length);"s"!=g&&(f+="s"),$("#navbar ul li").removeClass("active"),$("#navbar ul li#"+f).addClass("active")}}]),angular.module("appliMobileBatiChiffrageApp").controller("ChiffrageCtrl",["$scope","$location","$log",function(a,b,c){a.params=b.search(),a.$log=c;var d=window.location.hash.split("/")[1],e=d.substring(d.length-1,d.length);"s"!=e&&(d+="s"),$("#navbar ul li").removeClass("active"),$("#navbar ul li#"+d).addClass("active")}]),angular.module("appliMobileBatiChiffrageApp").controller("LoginCtrl",["$scope","$location","$http",function(a,b,c){a.formLogin={},a.formLogin.submitTheForm=function(d,e){console.log("--> Submitting form");var f={email:a.formLogin.email,password:a.formLogin.password},g="http://"+a.config.UrlBC+"/scripts/interface.php?mode=LOGIN&email="+f.email+"&pass="+f.password+"&cle_cryptage=&siret=&source=";c.post(g).success(function(c,d){'"KO"'!=c?(a.config.authentificated=!0,a.config.UId=c.UId,b.path("main")):(a.config.msgError=!0,b.path("login"))})},a.logout=function(){a.config.authentificated=!1,a.config.msgError=!1,b.path("login")}}]);